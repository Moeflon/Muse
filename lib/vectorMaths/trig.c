/**
 * @file trig.c
 * @author Vic Degraeve
 * @author Victor-Louis De Gusseme
 */

#include "trig.h"
#include <avr/io.h>

extern const int16_t sin_table[901] = {
	0,
	57,    114,   171,   228,   285,   343,   400,   457,   514,   571,
	629,   686,   743,   800,   857,   914,   972,   1029,  1086,  1143,
	1200,  1257,  1314,  1372,  1429,  1486,  1543,  1600,  1657,  1714,
	1771,  1829,  1886,  1943,  2000,  2057,  2114,  2171,  2228,  2285,
	2342,  2399,  2456,  2513,  2570,  2627,  2684,  2741,  2798,  2855,
	2912,  2969,  3026,  3083,  3140,  3197,  3254,  3311,  3368,  3424,
	3481,  3538,  3595,  3652,  3709,  3766,  3822,  3879,  3936,  3993,
	4049,  4106,  4163,  4220,  4276,  4333,  4390,  4446,  4503,  4560,
	4616,  4673,  4729,  4786,  4843,  4899,  4956,  5012,  5069,  5125,
	5182,  5238,  5295,  5351,  5407,  5464,  5520,  5577,  5633,  5689,
	5746,  5802,  5858,  5914,  5971,  6027,  6083,  6139,  6195,  6252,
	6308,  6364,  6420,  6476,  6532,  6588,  6644,  6700,  6756,  6812,
	6868,  6924,  6980,  7036,  7091,  7147,  7203,  7259,  7315,  7370,
	7426,  7482,  7537,  7593,  7649,  7704,  7760,  7815,  7871,  7926,
	7982,  8037,  8093,  8148,  8203,  8259,  8314,  8369,  8425,  8480,
	8535,  8590,  8646,  8701,  8756,  8811,  8866,  8921,  8976,  9031,
	9086,  9141,  9196,  9251,  9306,  9360,  9415,  9470,  9525,  9579,
	9634,  9689,  9743,  9798,  9852,  9907,  9961,  10016, 10070, 10125,
	10179, 10233, 10288, 10342, 10396, 10451, 10505, 10559, 10613, 10667,
	10721, 10775, 10829, 10883, 10937, 10991, 11045, 11099, 11152, 11206,
	11260, 11314, 11367, 11421, 11474, 11528, 11581, 11635, 11688, 11742,
	11795, 11849, 11902, 11955, 12008, 12061, 12115, 12168, 12221, 12274,
	12327, 12380, 12433, 12486, 12539, 12591, 12644, 12697, 12750, 12802,
	12855, 12907, 12960, 13012, 13065, 13117, 13170, 13222, 13274, 13327,
	13379, 13431, 13483, 13535, 13587, 13639, 13691, 13743, 13795, 13847,
	13899, 13951, 14002, 14054, 14106, 14157, 14209, 14260, 14312, 14363,
	14415, 14466, 14517, 14568, 14620, 14671, 14722, 14773, 14824, 14875,
	14926, 14977, 15028, 15078, 15129, 15180, 15231, 15281, 15332, 15382,
	15433, 15483, 15534, 15584, 15634, 15684, 15735, 15785, 15835, 15885,
	15935, 15985, 16035, 16085, 16134, 16184, 16234, 16283, 16333, 16383,
	16432, 16482, 16531, 16580, 16630, 16679, 16728, 16777, 16826, 16875,
	16924, 16973, 17022, 17071, 17120, 17168, 17217, 17266, 17314, 17363,
	17411, 17460, 17508, 17556, 17605, 17653, 17701, 17749, 17797, 17845,
	17893, 17941, 17989, 18037, 18084, 18132, 18180, 18227, 18275, 18322,
	18369, 18417, 18464, 18511, 18558, 18606, 18653, 18700, 18747, 18793,
	18840, 18887, 18934, 18980, 19027, 19073, 19120, 19166, 19213, 19259,
	19305, 19351, 19398, 19444, 19490, 19536, 19581, 19627, 19673, 19719,
	19764, 19810, 19855, 19901, 19946, 19992, 20037, 20082, 20127, 20172,
	20217, 20262, 20307, 20352, 20397, 20442, 20486, 20531, 20575, 20620,
	20664, 20709, 20753, 20797, 20841, 20885, 20929, 20973, 21017, 21061,
	21105, 21149, 21192, 21236, 21279, 21323, 21366, 21410, 21453, 21496,
	21539, 21582, 21625, 21668, 21711, 21754, 21797, 21839, 21882, 21924,
	21967, 22009, 22052, 22094, 22136, 22178, 22220, 22262, 22304, 22346,
	22388, 22430, 22471, 22513, 22554, 22596, 22637, 22678, 22720, 22761,
	22802, 22843, 22884, 22925, 22966, 23006, 23047, 23088, 23128, 23169,
	23209, 23249, 23290, 23330, 23370, 23410, 23450, 23490, 23530, 23570,
	23609, 23649, 23688, 23728, 23767, 23807, 23846, 23885, 23924, 23963,
	24002, 24041, 24080, 24119, 24157, 24196, 24234, 24273, 24311, 24350,
	24388, 24426, 24464, 24502, 24540, 24578, 24616, 24653, 24691, 24729,
	24766, 24803, 24841, 24878, 24915, 24952, 24989, 25026, 25063, 25100,
	25137, 25173, 25210, 25246, 25283, 25319, 25355, 25392, 25428, 25464,
	25500, 25536, 25571, 25607, 25643, 25678, 25714, 25749, 25784, 25820,
	25855, 25890, 25925, 25960, 25995, 26030, 26064, 26099, 26133, 26168,
	26202, 26237, 26271, 26305, 26339, 26373, 26407, 26441, 26474, 26508,
	26542, 26575, 26609, 26642, 26675, 26708, 26741, 26774, 26807, 26840,
	26873, 26906, 26938, 26971, 27003, 27035, 27068, 27100, 27132, 27164,
	27196, 27228, 27260, 27291, 27323, 27354, 27386, 27417, 27449, 27480,
	27511, 27542, 27573, 27604, 27634, 27665, 27696, 27726, 27757, 27787,
	27817, 27847, 27878, 27908, 27937, 27967, 27997, 28027, 28056, 28086,
	28115, 28145, 28174, 28203, 28232, 28261, 28290, 28319, 28347, 28376,
	28405, 28433, 28461, 28490, 28518, 28546, 28574, 28602, 28630, 28658,
	28685, 28713, 28740, 28768, 28795, 28822, 28850, 28877, 28904, 28931,
	28957, 28984, 29011, 29037, 29064, 29090, 29116, 29143, 29169, 29195,
	29221, 29246, 29272, 29298, 29323, 29349, 29374, 29399, 29425, 29450,
	29475, 29500, 29525, 29549, 29574, 29599, 29623, 29648, 29672, 29696,
	29720, 29744, 29768, 29792, 29816, 29839, 29863, 29886, 29910, 29933,
	29956, 29980, 30003, 30026, 30048, 30071, 30094, 30116, 30139, 30161,
	30184, 30206, 30228, 30250, 30272, 30294, 30315, 30337, 30359, 30380,
	30401, 30423, 30444, 30465, 30486, 30507, 30528, 30549, 30569, 30590,
	30610, 30631, 30651, 30671, 30691, 30711, 30731, 30751, 30770, 30790,
	30810, 30829, 30848, 30867, 30887, 30906, 30925, 30943, 30962, 30981,
	30999, 31018, 31036, 31055, 31073, 31091, 31109, 31127, 31145, 31162,
	31180, 31198, 31215, 31232, 31250, 31267, 31284, 31301, 31318, 31334,
	31351, 31368, 31384, 31401, 31417, 31433, 31449, 31465, 31481, 31497,
	31513, 31528, 31544, 31559, 31574, 31590, 31605, 31620, 31635, 31650,
	31664, 31679, 31694, 31708, 31722, 31737, 31751, 31765, 31779, 31793,
	31807, 31820, 31834, 31847, 31861, 31874, 31887, 31900, 31913, 31926,
	31939, 31952, 31965, 31977, 31990, 32002, 32014, 32026, 32038, 32050,
	32062, 32074, 32085, 32097, 32108, 32120, 32131, 32142, 32153, 32164,
	32175, 32186, 32197, 32207, 32218, 32228, 32238, 32248, 32258, 32268,
	32278, 32288, 32298, 32307, 32317, 32326, 32336, 32345, 32354, 32363,
	32372, 32381, 32389, 32398, 32406, 32415, 32423, 32431, 32439, 32447,
	32455, 32463, 32471, 32478, 32486, 32493, 32501, 32508, 32515, 32522,
	32529, 32536, 32543, 32549, 32556, 32562, 32568, 32575, 32581, 32587,
	32593, 32599, 32604, 32610, 32616, 32621, 32626, 32632, 32637, 32642,
	32647, 32651, 32656, 32661, 32665, 32670, 32674, 32678, 32683, 32687,
	32691, 32694, 32698, 32702, 32705, 32709, 32712, 32715, 32718, 32722,
	32724, 32727, 32730, 32733, 32735, 32738, 32740, 32742, 32744, 32746,
	32748, 32750, 32752, 32754, 32755, 32757, 32758, 32759, 32760, 32761,
	32762, 32763, 32764, 32765, 32765, 32766, 32766, 32766, 32766, 32767, 
};

int16_t sin_lookup(int16_t angle) {
	int sign = 1;
	if(angle < 0) {
		angle = -angle;
		sign = -1;
	}
	if(angle > 900 && angle <= 1800) {
		angle = 1800 - angle;
	}
	else if(angle > 1800) {
		angle -= 1800;
		sign = -1;
	}
	return sign * sin_table[angle];
}

int16_t cos_lookup(int16_t angle) {
	return sin_lookup(900 - angle);
}
